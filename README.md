## Improving sequence-based modeling of protein families using secondary structure quality assessment

**Motivation** 
Modeling of protein family sequence distribution from homologous sequence data recently received considerable 
attention, in particular for structure and function predictions, as well as for protein design.  In particular,
Direct Coupling Analysis models drove a lot of attention for their ability to model important correlation in 
protein sequences. Building on these models and other graphical models, we introduce a new framework to assess 
the quality of the secondary structures of the generated sequences with respect to reference structures for 
the family.

**Results**
We introduce two scoring functions characterizing the likeliness of the secondary structure of a protein sequence
to match a reference structure, called Dot Product and Pattern Matching. We test these scores on  published
experimental protein mutagenesis and design dataset, and show improvement in the detection of non-functional
sequences. We also show that use of these scores help rejecting non-functional sequences generated by graphical
models (Restricted Boltzmann Machines) learned from homologous sequence alignments. 

Take a look at our [paper]()

In this repository, we provide :
- Scripts to format data from FASTA file in `data/` as well as all necessary data structure.
- Scripts for performing the diverse Secondary Structure Quality Assessment in `ssqa/` and generative
  algorithms taking into account SSQA in `generation/`
- Implementation of RBM, adaptable to more complex Markov Random Fields model in `pgm/`
- Tutorials and Notebooks to get the results of the paper in `notebooks/`

To use these scripts please install all required Python libraries from `requirements.txt` as well as
[MMSEQS](https://github.com/soedinglab/MMseqs2) and [HH-suite](https://github.com/soedinglab/hh-suite). 
Also, download the working [data]() and add yours easily following the tutorials. Once done, update
the `config.py` with your own absolute path to your data folder to avoid any bug.

### Data Availability

All data are available to download in this [Google Drive folder](https://drive.google.com/drive/folders/1pD1QtMm2ZhHvJeZeF6eRUeU2GrOscnyS?usp=sharing) :
- [`cross`](https://drive.google.com/file/d/1cgxa5qa8vcpkjMPavBQMG7XXbKQOKu90/view?usp=sharing) for cross references between different databases : Uniprot, Pfam, Pdb
- [`pfam`](https://drive.google.com/file/d/1RzK0UzP5H9lnelkQohTCweQgxEvEacYA/view?usp=sharing) for data retrieve on PFAM
- [`mut`](https://drive.google.com/file/d/1Lt26YVbxKwNag6KifrhrYc_B1HL7XuvU/view?usp=sharing) for data retrieve from Hopf et al. (2017) reformat for the needs of our works
- [`utils`](https://drive.google.com/file/d/1MwRV5_ofAlV9ePD3JwCDlfheHzHrxVBY/view?usp=sharing) for training and validation set use for secondary structure inference, including own 
  trained weights for NetSurfP2 
  
Please, should these links expires, don't hesitate to reach out for us.

### Contact

If you have any question please feel free to contact me at [cyril.malbranke@ens.fr](mailto:cyril.malbranke@ens.fr)